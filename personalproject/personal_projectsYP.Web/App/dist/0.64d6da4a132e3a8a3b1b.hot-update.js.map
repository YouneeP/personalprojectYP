{"version":3,"file":"0.64d6da4a132e3a8a3b1b.hot-update.js","sources":["C:/sandbox/repos/personalprojectYP/personalproject/personal_projectsYP.Web/App/src/components/user.js"],"sourcesContent":["import React, { Component } from 'react';\r\nimport $ from 'jquery';\r\nimport { Button, Nav, Navbar, NavDropdown, MenuItem, NavItem, Grid, Row, Col} from 'react-bootstrap';\r\nimport registerform from '../img/registerpage.png';\r\n\r\nclass User extends Component {\r\n  constructor(props, context) {\r\n    super(props, context);\r\n    this.state = {\r\n        accountId:'',\r\n        meal:'',\r\n        quantity:'',\r\n        editMode:false,\r\n        resultMode:false,\r\n        mealId:'',\r\n        user:[],\r\n        userMeal:[],\r\n        singleMeal:[]\r\n    };\r\n    this.handleChange = this.handleChange.bind(this);\r\n    this.submit = this.submit.bind(this);\r\n    this.edit = this.edit.bind(this);\r\n    this.delete = this.delete.bind(this);\r\n    this.submitChange = this.submitChange.bind(this);\r\n    this.getCalculate = this.getCalculate.bind(this);\r\n  }\r\n\r\n  componentDidMount(){\r\n    let cookie = document.cookie;\r\n    if(cookie === null){\r\n      window.location.href = \"http://localhost:57432/login\"\r\n    }\r\n    else{\r\n      let accountId = cookie.split(\"=\")[1];\r\n      this.setState({\r\n        accountId:accountId\r\n      },()=>this.getByAccountId());\r\n    }\r\n  }\r\n\r\n  getByAccountId(){\r\n    let accountId = this.state.accountId;\r\n    fetch(\"/api/user/\"+accountId,{\r\n      method: 'GET',\r\n      headers:{'Content-Type':'application/json'},\r\n      credentials: 'include'\r\n    }).then((resp)=>resp.json())\r\n    .then(function(data){\r\n      let item = [data.Item];\r\n      this.setState({\r\n        user:item\r\n      },()=>this.getUserMeal())\r\n    }.bind(this))   \r\n  }\r\n\r\n  getUserMeal(){\r\n    let accountId = this.state.accountId;\r\n    fetch(\"/api/user/todaymeal/\"+accountId,{\r\n      method: 'GET',\r\n      headers:{'Content-Type':'application/json'},\r\n      credentials: 'include'\r\n    }).then((resp)=>resp.json())\r\n    .then(function(data){\r\n      let item = data.Items;\r\n        for(var i=0; i<item.length; i++){\r\n          item[i].CreatedDateOnly = item[i].CreatedDate.split(\"T\")[0];\r\n        }\r\n      this.setState({\r\n        userMeal:item\r\n      })\r\n    }.bind(this))   \r\n  }\r\n\r\n  handleChange(event) {\r\n    const target = event.target;\r\n    const value = target.value;\r\n    const name = target.name;\r\n    this.setState({\r\n        [name]: value\r\n    });\r\n  }\r\n\r\n  edit(id){\r\n    fetch(\"/api/user/singlemeal/\"+id,{\r\n      method: 'GET',\r\n      headers:{'Content-Type':'application/json'},\r\n      credentials: 'include'\r\n    }).then((resp)=>resp.json())\r\n    .then(function(data){\r\n      let item =data.Item;\r\n      this.setState({\r\n        accountId:item.AccountId,\r\n        meal:item.Meal,\r\n        mealId:item.Id,\r\n        quantity:item.Quantity,\r\n        editMode:true\r\n      })\r\n    }.bind(this)) \r\n  }\r\n\r\n  submitChange(){\r\n    let Id = this.state.mealId;\r\n    fetch(\"/api/user/update/\"+Id,{\r\n      method: 'PUT',\r\n      headers:{'Content-Type':'application/json'},\r\n      body:JSON.stringify({\r\n        Id: Id,\r\n        AccountId: this.state.accountId,\r\n        Meal:this.state.meal,\r\n        Quantity:this.state.quantity\r\n      }),\r\n      credentials: 'include'\r\n    })\r\n    .then(function(response){\r\n      this.setState({\r\n        meal:'',\r\n        quantity:'',\r\n        editMode:false\r\n      }, ()=>this.getUserMeal())\r\n    }.bind(this));\r\n  }\r\n\r\n  delete(id){\r\n    fetch(\"/api/user/delete/\"+id,{\r\n      method:'delete'\r\n    }).then(function(response){\r\n      this.setState({\r\n        editModel:false\r\n      }, ()=>this.getUserMeal())\r\n    }.bind(this));\r\n  }\r\n\r\n  submit(event){\r\n    event.preventDefault();\r\n    fetch(\"/api/user/meal\",{\r\n      method: 'POST',\r\n      headers: {'Content-Type':'application/json'},\r\n      body:JSON.stringify ({\r\n        AccountId:this.state.accountId,\r\n        Meal:this.state.meal,\r\n        Quantity:this.state.quantity\r\n      }),\r\n      credentials:'include'\r\n    })\r\n    .then(function(response){\r\n      this.setState({\r\n        meal:'',\r\n        quantity:''\r\n      },()=>this.getUserMeal())\r\n    }.bind(this));   \r\n  }\r\n\r\n  getCalculate(){\r\n    let userMeal = this.state.userMeal;\r\n    for(var i=0; i<userMeal.length; i++){\r\n      fetch(\"https://api.nal.usda.gov/ndb/search/?format=json&q=\" +userMeal[i].Meal+\"&sort=n&max=25&offset=0&api_key=iePhBf4DTI9UStixHQvpqeNZnlICZEKRITy2HpQV\",{\r\n        method: 'GET',\r\n        headers:{'Content-Type':'application/json'}\r\n      }).then((resp)=>resp.json())\r\n      .then(function(data){\r\n        if(data.list){\r\n          let fooddata=data.list;\r\n          let item = fooddata.item[0];\r\n          let ndbono = item.ndbno\r\n            fetch(\"https://api.nal.usda.gov/ndb/reports/?ndbno=\"+ndbono+\"&type=b&format=json&api_key=iePhBf4DTI9UStixHQvpqeNZnlICZEKRITy2HpQV\",{\r\n              method: 'GET',\r\n              headers:{'Content-Type':'application/json'}\r\n            }).then((resp)=>resp.json()\r\n            .then(function(data){\r\n              let nutrientData = data.report.food;\r\n              console.log(nutrientData);\r\n            }))\r\n        }\r\n        else if(data.errors){\r\n          alert(\"Please check your input\");\r\n        }\r\n      })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <div className=\"row\">\r\n          <div className=\"col-md-4 m-t-sm m-l-md\" >\r\n            <div className=\"card askForm\">\r\n              <img className=\"card-img-top img-responsive m-b-sm\" src={registerform} />\r\n              <div className=\"card-body\">\r\n                <form className=\"form-group\" onSubmit={this.submit}> \r\n                  <label>What have you eat today?</label>\r\n                      <input type=\"text\" onChange={this.handleChange} className=\"form-control m-b-sm\" name=\"meal\" value={this.state.meal} />\r\n                  <label>Quantity</label>\r\n                      <input type=\"number\" onChange={this.handleChange} className=\"form-control m-b-sm\" name=\"quantity\" value={this.state.quantity} />\r\n                  {this.state.editMode === true ? \r\n                  <div>\r\n                    <button type=\"button\" onClick={this.submitChange} className=\"btn btn-secondary btn-lg btn-block m-t-md\">Edit</button>\r\n                  </div>\r\n                  : \r\n                  <button type=\"submit\" className=\"btn btn-primary btn-lg btn-block m-t-md\">Submit</button>}\r\n                  \r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n            {this.state.user.map( user =>\r\n              <div className=\"col-md-4 m-t-sm\" key={user.Id}>\r\n                <div className=\"card mealList\">\r\n                  <div className=\"card-header bg-dark text-white\">\r\n                    Today, {user.FirstName} {user.LastName} Ate ...\r\n                  </div>\r\n                  <div className=\"card-body\">\r\n                    {this.state.userMeal.map (userMeal =>\r\n                      <div key={userMeal.Id}>\r\n                        <div className=\"row\">\r\n                          <button \r\n                            type=\"button\" \r\n                            onClick={()=>this.edit(userMeal.Id)} \r\n                            className=\"btn btn-outline-secondary m-l-sm m-b-xs\"\r\n                          >{userMeal.Meal} x {userMeal.Quantity}</button>\r\n                          <i className=\"fa fa-close m-l-xs\" onClick={ ()=>this.delete(userMeal.Id)} />\r\n                        </div>\r\n                      </div>\r\n                    )}\r\n                    <button type=\"button\" className=\"btn btn-primary m-t-md\" onClick={this.getCalculate}>Calculate</button>\r\n                  </div>\r\n                </div>\r\n                {this.state.resultMode === true ? \r\n                  <div className=\"result m-t-sm\">\r\n                    <div className=\"card\">\r\n                      <div className=\"card-header  bg-dark text-white\">\r\n                        You Ate ...\r\n                      </div>\r\n                      <div className=\"card-body\">\r\n                        Energy: <br/>\r\n                        Protein: <br/>\r\n                        Fat: <br/>\r\n                        Carbohydrates: <br/>\r\n                        Sugars: <br/>\r\n                        Sodium: <br/>\r\n                      </div>\r\n                  </div>\r\n                </div>\r\n                : null}\r\n              </div>\r\n            )}\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default User;\r\n\r\n// fetch(\"https://api.nal.usda.gov/ndb/reports/?ndbno=\"+ndbono+\"&type=b&format=json&api_key=iePhBf4DTI9UStixHQvpqeNZnlICZEKRITy2HpQV\",{\r\n//   method: 'GET',\r\n//   headers:{'Content-Type':'application/json'}\r\n// }).then((resp)=>resp.json()\r\n// .then(function(data){\r\n//   let nutrientData = data.report.food;\r\n//   console.log(nutrientData);\r\n// }))\n\n\n// WEBPACK FOOTER //\n// src/components/user.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;;;AACA;AAAA;AACA;AADA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAWA;AACA;AACA;AACA;AACA;AACA;AAlBA;AAmBA;AACA;;;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AADA;AAEA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAHA;AAIA;AAAA;AACA;AACA;AAAA;AACA;AACA;AADA;AAEA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAHA;AAIA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AAGA;;;AAEA;AACA;AACA;AACA;AACA;AAHA;AAIA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAJA;AAMA;AATA;AAWA;AACA;AAAA;AACA;AACA;AACA;AAHA;AAIA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AADA;AAEA;AACA;AAAA;AACA;AADA;AAEA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AARA;AAUA;AACA;AAAA;AACA;AACA;AAFA;AAGA;AAAA;AACA;AACA;;;AAEA;AACA;AACA;AACA;AACA;AACA;AAFA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAGA;AAEA;AACA;AACA;AAJA;AAKA;AAEA;AACA;AACA;AACA;AACA;;;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAVA;AADA;AAFA;AADA;AAoBA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAJA;AAIA;AAJA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AADA;AADA;AAYA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAbA;AAJA;AAoBA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAFA;AAGA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAJA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AALA;AAMA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AANA;AAJA;AADA;AAtBA;AADA;AArBA;AADA;AAkEA;;;;AAnPA;AACA;AAqPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}